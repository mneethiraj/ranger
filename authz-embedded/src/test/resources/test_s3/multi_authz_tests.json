[
  {
    "comment": "tests for path1-r-userc"
  },
  {
    "request": {
      "requestId": "path1-r-user empty accesses",
      "user":      { "name": "path1-r-user" },
      "accesses":  [ ],
      "context":   { "serviceName": "dev_s3" }
    },
    "result": {
      "requestId": "path1-r-user empty accesses",
      "decision":  "ALLOW",
      "accesses": [ ]
    }
  },
  {
    "request": {
      "requestId": "path1-r-user read /data/path1/file.orc",
      "user":      { "name": "path1-r-user" },
      "accesses":  [
        { "resource": "path:mybucket/data/path1/file.orc", "action": "read", "permissions": [ "read" ] }
      ],
      "context":   { "serviceName": "dev_s3" }
    },
    "result": {
      "requestId": "path1-r-user read /data/path1/file.orc",
      "decision":  "ALLOW",
      "accesses": [
        {
          "decision":  "ALLOW",
          "permissions": {
            "read": { "permission": "read", "access": { "decision": "ALLOW", "policy": { "id": 1, "version": 1 } } }
          }
        }
      ]
    }
  },
  {
    "request": {
      "requestId": "path1-r-user read [/data/path1/file.orc,/data/path1/file2.orc]",
      "user":      { "name": "path1-r-user" },
      "accesses": [
        { "resource": "path:mybucket/data/path1/file.orc",  "action": "read", "permissions": [ "read" ] },
        { "resource": "path:mybucket/data/path1/file2.orc", "action": "read", "permissions": [ "read" ] }
      ],
      "context":   { "serviceName": "dev_s3" }
    },
    "result": {
      "requestId": "path1-r-user read [/data/path1/file.orc,/data/path1/file2.orc]",
      "decision":  "ALLOW",
      "accesses": [
        {
          "decision":  "ALLOW",
          "permissions": {
            "read": { "permission": "read", "access": { "decision": "ALLOW", "policy": { "id": 1, "version": 1 } } }
          }
        },
        {
          "decision":  "ALLOW",
          "permissions": {
            "read": { "permission": "read", "access": { "decision": "ALLOW", "policy": { "id":  1, "version": 1 } } }
          }
        }
      ]
    }
  },
  {
    "request": {
      "requestId": "path1-r-user [read write] /data/path1/file.orc",
      "user":      { "name": "path1-r-user" },
      "accesses": [
        { "resource": "path:mybucket/data/path1/file.orc", "action": "read",  "permissions": [ "read" ] },
        { "resource": "path:mybucket/data/path1/file.orc", "action": "write", "permissions": [ "write" ] }
      ],
      "context":   { "serviceName": "dev_s3" }
    },
    "result": {
      "requestId": "path1-r-user [read write] /data/path1/file.orc",
      "decision":  "PARTIAL",
      "accesses": [
        {
          "decision":  "ALLOW",
          "permissions": {
            "read": { "permission": "read", "access": { "decision": "ALLOW", "policy": { "id": 1, "version": 1 } } }
          }
        },
        {
          "decision":  "DENY",
          "permissions": {
            "write": { "permission": "write", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
          }
        }
      ]
    }
  },
  {
    "request": {
      "requestId": "path1-r-user write [/data/path1/file.orc,/data/path2/file.orc]",
      "user":      { "name": "path1-r-user" },
      "accesses":  [
        { "resource": "path:mybucket/data/path1/file.orc", "action": "write", "permissions": [ "write" ] },
        { "resource": "path:mybucket/data/path2/file.orc", "action": "write", "permissions": [ "write" ] }
      ],
      "context":   { "serviceName": "dev_s3" }
    },
    "result": {
      "requestId": "path1-r-user write [/data/path1/file.orc,/data/path2/file.orc]",
      "decision":  "DENY",
      "accesses": [
        {
          "decision":  "DENY",
          "permissions": {
            "write": { "permission": "write", "access": { "decision": "DENY", "policy": { "id": -1 } } }
          }
        },
        {
          "decision":  "DENY",
          "permissions": {
            "write": { "permission": "write", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
          }
        }
      ]
    }
  },
  {
    "request": {
      "requestId": "path1-r-user write [/data/null/file.orc,/data/null/file2.orc]",
      "user":      { "name": "path1-r-user" },
      "accesses":  [
        { "resource": "path:mybucket/data/null/file.orc", "action": "write", "permissions": [ "write" ] },
        { "resource": "path:mybucket/data/null/file2.orc", "action": "write", "permissions": [ "write" ] }
      ],
      "context":   { "serviceName": "dev_s3" }
    },
    "result": {
      "requestId": "path1-r-user write [/data/null/file.orc,/data/null/file2.orc]",
      "decision":  "DENY",
      "accesses": [
        {
          "decision":  "DENY",
          "permissions": {
            "write": { "permission": "write", "access": { "decision": "DENY", "policy": { "id": -1 } } }
          }
        },
        {
          "decision":  "DENY",
          "permissions": {
            "write": { "permission": "write", "access": { "decision": "DENY", "policy": { "id":  -1 } } }
          }
        }
      ]
    }
  }
]